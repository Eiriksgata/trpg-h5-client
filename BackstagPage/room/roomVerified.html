<!DOCTYPE html>
<html class="x-admin-sm">

	<head>
		<meta charset="UTF-8">
		<title>房间验证</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
		<link rel="stylesheet" href="../resource/css/font.css">
		<link rel="stylesheet" href="../resource/css/xadmin.css">
		<script type="text/javascript" src="../resource/lib/layui/layui.js" charset="utf-8"></script>
		<script type="text/javascript" src="../resource/lib/xadmin.js"></script>
		<script type="text/javascript" src="../resource/lib/jquery.min.js"></script>
		<!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
		<!--[if lt IE 9]>
            <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
            <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
	</head>

	<body style="height: 100%;">

		<div class="layui-row">
			<div class="layui-container" style="padding-top: 100px; height: 100%;max-width: 250px;">
				<form class="layui-form">
					<span class="x-red">*</span>密码
					<input name="password" type="password" class="layui-input" />

				</form>
				<button onclick="joinRoomSubmit()" class="layui-btn" style="width: 100%;">
                          	确认
               </button>
			</div>

		</div>
	</body>

	<script>
		var findRoomId = window.location.search.substring(8);

		function joinRoomSubmit() {

			var password = $("input[name=password]").val();
			var jsonData = {
				"password": password,
				"roomId": parseInt(findRoomId)

			};
			$.ajax({
				type: "put",
				url: "http://localhost/joinRoom",
				data: JSON.stringify(jsonData),
				dataType: "json",
				xhrFields: {
					withCredentials: true
				},
				crossDomain: true,
				contentType: "application/json;charset=UTF-8",
				success: function(result) {

					if(result.code == 1) {
						layer.msg(result.message);
						alert(result.message);
					}

					if(result.code == 0) {
						layer.msg(result.message);

						//计时关闭自身
						setTimeout(function() {
							//关闭当前frame
							xadmin.close();
							// 可以对父窗口进行刷新 
							xadmin.father_reload();
						}, 1500);
					}
				}
			});

		}
	</script>

</html>